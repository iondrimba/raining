!function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=2)}([function(e,t,i){var n;e.exports=((n=function(){function e(e){return r.appendChild(e.dom),e}function t(e){for(var t=0;t<r.children.length;t++)r.children[t].style.display=t===e?"block":"none";i=e}var i=0,r=document.createElement("div");r.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",r.addEventListener("click",(function(e){e.preventDefault(),t(++i%r.children.length)}),!1);var a=(performance||Date).now(),s=a,o=0,h=e(new n.Panel("FPS","#0ff","#002")),d=e(new n.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var l=e(new n.Panel("MB","#f08","#201"));return t(0),{REVISION:16,dom:r,addPanel:e,showPanel:t,begin:function(){a=(performance||Date).now()},end:function(){o++;var e=(performance||Date).now();if(d.update(e-a,200),e>s+1e3&&(h.update(1e3*o/(e-s),100),s=e,o=0,l)){var t=performance.memory;l.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){a=this.end()},domElement:r,setMode:t}}).Panel=function(e,t,i){var n=1/0,r=0,a=Math.round,s=a(window.devicePixelRatio||1),o=80*s,h=48*s,d=3*s,l=2*s,c=3*s,u=15*s,f=74*s,p=30*s,m=document.createElement("canvas");m.width=o,m.height=h,m.style.cssText="width:80px;height:48px";var g=m.getContext("2d");return g.font="bold "+9*s+"px Helvetica,Arial,sans-serif",g.textBaseline="top",g.fillStyle=i,g.fillRect(0,0,o,h),g.fillStyle=t,g.fillText(e,d,l),g.fillRect(c,u,f,p),g.fillStyle=i,g.globalAlpha=.9,g.fillRect(c,u,f,p),{dom:m,update:function(h,w){n=Math.min(n,h),r=Math.max(r,h),g.fillStyle=i,g.globalAlpha=1,g.fillRect(0,0,o,u),g.fillStyle=t,g.fillText(a(h)+" "+e+" ("+a(n)+"-"+a(r)+")",d,l),g.drawImage(m,c+s,u,f-s,p,c,u,f-s,p),g.fillRect(c+f-s,u,s,p),g.fillStyle=i,g.globalAlpha=.9,g.fillRect(c+f-s,u,s,a((1-h/w)*p))}}},n)},function(e,t,i){},function(e,t,i){"use strict";i.r(t);var n=i(0),r=i.n(n),a=(i(1),function(e,t,i,n,r){return n+(e-t)/(i-t)*(r-n)}),s=function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16)/255,g:parseInt(t[2],16)/255,b:parseInt(t[3],16)/255}:null};function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,i,n;return t=e,(i=[{key:"setup",value:function(){var e=this;this.stats=new r.a,this.stats.showPanel(0),document.body.appendChild(this.stats.dom),this.gui=new dat.GUI,this.backgroundColor="#faff06",this.gutter={size:0},this.meshes=[],this.grid={cols:30,rows:30},this.width=window.innerWidth,this.height=window.innerHeight,this.velocity=-.1,this.angle=0,this.amplitude=.1,this.radius=1,this.waveLength=200,this.ripple={},this.interval=0,this.waterDropPositions=[],this.ripples=[],this.gui.addFolder("Background").addColor(this,"backgroundColor").onChange((function(e){document.body.style.backgroundColor=e})),window.addEventListener("resize",this.onResize.bind(this),{passive:!0}),window.addEventListener("visibilitychange",(function(t){e.pause=t.target.hidden}),!1)}},{key:"createScene",value:function(){this.scene=new THREE.Scene,this.renderer=new THREE.WebGLRenderer({antialias:!0,alpha:!0}),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=THREE.PCFSoftShadowMap,document.body.appendChild(this.renderer.domElement)}},{key:"createCamera",value:function(){var e=window.innerWidth,t=window.innerHeight;this.camera=new THREE.PerspectiveCamera(10,e/t,1,1e3),this.camera.position.set(-180,180,180),this.scene.add(this.camera)}},{key:"addAmbientLight",value:function(){var e=new THREE.AmbientLight("#fff",1);this.scene.add(e)}},{key:"addDirectionalLight",value:function(){this.directionalLight=new THREE.DirectionalLight(16777215,1,1e3),this.directionalLight.castShadow=!0,this.directionalLight.position.set(0,1,0),this.directionalLight.shadow.camera.far=1e3,this.directionalLight.shadow.camera.near=-200,this.directionalLight.shadow.camera.left=-40,this.directionalLight.shadow.camera.right=40,this.directionalLight.shadow.camera.top=20,this.directionalLight.shadow.camera.bottom=-20,this.directionalLight.shadow.camera.zoom=1,this.directionalLight.shadow.camera.needsUpdate=!0;var e=new THREE.Object3D;e.position.set(-50,-82,40),this.directionalLight.target=e,this.scene.add(this.directionalLight),this.scene.add(this.directionalLight.target)}},{key:"createGrid",value:function(){this.groupMesh=new THREE.Object3D;var e={color:"#1643e5",metalness:.3,emissive:"#000000",roughness:1},t=new THREE.MeshPhysicalMaterial(e);this.gui.addFolder("Water").addColor(e,"color").onChange((function(e){t.color=s(e)}));var i=new THREE.BoxBufferGeometry(1,1,1);this.mesh=this.getMesh(i,t,this.grid.rows*this.grid.cols),this.scene.add(this.mesh),this.centerX=.4*(this.grid.cols+this.grid.cols*this.gutter.size),this.centerZ=.6*(this.grid.rows+this.grid.rows*this.gutter.size);for(var n=0,r=0;r<this.grid.rows;r++){this.meshes[r]=[];for(var a=0;a<this.grid.cols;a++){var o=new THREE.Object3D,h=a+a*this.gutter.size,d=r+r*this.gutter.size;o.scale.set(1,1,1),o.position.set(h-this.centerX,0,d-this.centerZ),this.meshes[r][a]=o,o.updateMatrix(),this.mesh.setMatrixAt(n++,o.matrix)}}this.mesh.instanceMatrix.needsUpdate=!0;for(var l=0;l<this.grid.rows;l++)for(var c=0;c<this.grid.cols;c++){var u=c+c*this.gutter.size,f=l+l*this.gutter.size;this.waterDropPositions.push({x:u-this.centerX,z:f-this.centerZ})}}},{key:"getMesh",value:function(e,t,i){var n=new THREE.InstancedMesh(e,t,i);return n.instanceMatrix.setUsage(THREE.DynamicDrawUsage),n.castShadow=!0,n.receiveShadow=!0,n}},{key:"addCameraControls",value:function(){this.controls=new THREE.OrbitControls(this.camera,this.renderer.domElement)}},{key:"addFloor",value:function(){var e=new THREE.PlaneGeometry(100,100),t=new THREE.ShadowMaterial({opacity:.3});this.floor=new THREE.Mesh(e,t),this.floor.name="floor",this.floor.position.y=-1,this.floor.rotateX(-Math.PI/2),this.floor.receiveShadow=!0,this.scene.add(this.floor)}},{key:"onResize",value:function(){this.width=window.innerWidth,this.height=window.innerHeight,this.camera.aspect=this.width/this.height,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.width,this.height)}},{key:"addWaterDrop",value:function(e,t){return new THREE.Mesh(e,t)}},{key:"getRandomWaterDropPosition",value:function(){return this.waterDropPositions[Math.floor(Math.random()*Math.floor(this.waterDropPositions.length))]}},{key:"animateWaterDrops",value:function(){var e=this,t={color:"#6ad2ff",metalness:0,emissive:"#000000",roughness:1},i=new THREE.BoxBufferGeometry(.5,2,.5),n=new THREE.MeshStandardMaterial(t);this.gui.addFolder("Drop").addColor(t,"color").onChange((function(e){n.color=s(e)})),this.interval=setInterval((function(){var t=e.addWaterDrop(i,n),r=e.getRandomWaterDropPosition(),a=r.x,s=r.z;t.position.set(a,50,s),e.scene.add(t),e.pause?(e.scene.remove(t),TweenMax.killAll(!0)):TweenMax.to(t.position,.5,{ease:Sine.easeIn,y:-2,onUpdate:function(){t.position.y<1&&e.ripples.push({x:a,z:s,velocity:-1,angle:0,amplitude:.1,radius:1,motion:-.7})},onComplete:function(){t.position.set(0,50,0),e.scene.remove(t)}})}),100)}},{key:"draw",value:function(){for(var e,t,i,n,r=0,s=0;s<this.grid.rows;s++)for(var o=0;o<this.grid.cols;o++){for(var h=this.meshes[s][o],d=0;d<this.ripples.length;d++){var l=this.ripples[d],c=(e=o,t=s,i=l.x+this.centerX,n=l.z+this.centerZ,Math.sqrt(Math.pow(e-i,2)+Math.pow(t-n,2)));if(c<l.radius){var u=a(c,0,-this.waveLength,-100,100),f=l.angle+u,p=a(Math.sin(f),-1,0,l.motion>0?0:l.motion,0);h.position.y=p}}h.updateMatrix(),this.mesh.setMatrixAt(r++,h.matrix)}for(var m=0;m<this.ripples.length;m++){var g=this.ripples[m];g.angle-=2*this.velocity,g.radius-=3*this.velocity,g.motion-=this.velocity/5,g.radius>50&&this.ripples.shift()}this.mesh.instanceMatrix.needsUpdate=!0}},{key:"animate",value:function(){this.stats.begin(),this.controls.update(),this.draw(),this.renderer.render(this.scene,this.camera),this.stats.end(),requestAnimationFrame(this.animate.bind(this))}},{key:"init",value:function(){this.setup(),this.createScene(),this.createCamera(),this.addAmbientLight(),this.addDirectionalLight(),this.createGrid(),this.addCameraControls(),this.addFloor(),this.animate(),this.draw(),this.animateWaterDrops()}}])&&o(t.prototype,i),n&&o(t,n),e}())).init()}]);